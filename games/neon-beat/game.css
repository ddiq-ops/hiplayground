@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@500;700&display=swap');

/* 전체 래퍼 */
.nb-wrapper {
  width: 100%; height: 100%;
  display: flex; flex-direction: column;
  background: radial-gradient(circle at center, #050505 0%, #1a1a2e 100%);
  color: #fff; font-family: 'Orbitron', sans-serif;
  overflow: hidden; user-select: none; position: relative;
}

/* 배경 그리드 */
.nb-bg-grid {
  position: absolute; top: 0; left: 0; width: 200%; height: 200%;
  background-image: linear-gradient(rgba(0,255,255,0.03) 1px, transparent 1px),
                    linear-gradient(90deg, rgba(0,255,255,0.03) 1px, transparent 1px);
  background-size: 80px 80px;
  transform: perspective(800px) rotateX(60deg) translateY(0) translateZ(-200px);
  animation: gridMove 20s linear infinite; pointer-events: none; z-index: 0;
}
@keyframes gridMove {
  0% { transform: perspective(800px) rotateX(60deg) translateY(0) translateZ(-200px); }
  100% { transform: perspective(800px) rotateX(60deg) translateY(80px) translateZ(-200px); }
}

/* --- 상단 헤더 (인게임) --- */
.nb-header {
  flex: 0 0 70px; display: flex; justify-content: space-between; align-items: center;
  padding: 0 25px; background: rgba(0,0,0,0.6); border-bottom: 1px solid rgba(255,255,255,0.1);
  z-index: 10; backdrop-filter: blur(5px);
}
.nb-music-info { text-align: left; }
.nb-music-title { font-size: 1.2rem; color: #00ffff; text-shadow: 0 0 10px #00ffff; }
.nb-music-meta { font-size: 0.8rem; color: #aaa; font-family: 'Rajdhani', sans-serif; }

.nb-score-box { text-align: right; }
.nb-val { font-size: 1.8rem; font-weight: 900; }
.nb-label { font-size: 0.8rem; color: #ff00ff; }

/* --- 게임 영역 --- */
.nb-game-area { flex: 1; position: relative; overflow: hidden; z-index: 5; }
canvas { display: block; width: 100%; height: 100%; }

/* --- 프로그레스 바 (곡 진행도) --- */
.nb-progress-container {
  position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: #333; z-index: 15;
}
.nb-progress-fill {
  height: 100%; background: #00ff00; width: 0%; box-shadow: 0 0 10px #00ff00; transition: width 0.5s linear;
}

/* --- 판정 및 체력 --- */
.nb-judge {
  position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%);
  font-size: 4rem; font-weight: 900; font-style: italic; pointer-events: none;
  opacity: 0; z-index: 20; text-align: center; white-space: nowrap;
}
.nb-judge.pop { animation: judgePop 0.3s forwards; }

.nb-hp-gauge {
  position: absolute; right: 20px; top: 50%; transform: translateY(-50%);
  width: 10px; height: 60%; background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3); border-radius: 5px; overflow: hidden;
}
.nb-hp-fill-v {
  position: absolute; bottom: 0; left: 0; width: 100%; height: 100%;
  background: linear-gradient(to top, #ff0055, #00ffff);
  transition: height 0.1s;
}

/* --- 컨트롤러 --- */
.nb-controls {
  flex: 0 0 120px; display: flex; background: rgba(0,0,0,0.8);
  border-top: 2px solid #00ffff; padding-bottom: 20px; z-index: 20;
}
.nb-key {
  flex: 1; display: flex; justify-content: center; align-items: flex-end;
  padding-bottom: 20px; border-right: 1px solid rgba(255,255,255,0.05); position: relative;
}
.nb-key:last-child { border-right: none; }
.nb-key.active { background: linear-gradient(to top, rgba(0,255,255,0.3), transparent); }
.nb-key-char { font-size: 1.5rem; color: #fff; opacity: 0.5; font-weight: bold; }

/* --- 곡 선택 화면 (Song Select) --- */
.nb-select-screen {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.95); z-index: 100;
  display: flex; flex-direction: column; padding: 40px;
}
.nb-select-header { font-size: 3rem; color: #fff; margin-bottom: 30px; text-shadow: 0 0 20px #00ffff; }

.nb-song-list {
  flex: 1; overflow-y: auto; padding-right: 20px;
  display: flex; flex-direction: column; gap: 10px;
}
.nb-song-item {
  display: flex; justify-content: space-between; align-items: center;
  padding: 20px; border: 1px solid rgba(255,255,255,0.2);
  background: linear-gradient(90deg, rgba(255,255,255,0.05), transparent);
  cursor: pointer; transition: all 0.2s;
}
.nb-song-item:hover {
  background: linear-gradient(90deg, rgba(0,255,255,0.2), transparent);
  border-left: 5px solid #00ffff; padding-left: 25px;
}
.nb-song-info h3 { margin: 0; font-size: 1.5rem; color: #fff; }
.nb-song-info p { margin: 5px 0 0; color: #aaa; font-family: 'Rajdhani'; font-size: 1rem; }
.nb-song-bpm { font-size: 2rem; font-weight: bold; color: #555; opacity: 0.5; }

/* --- 모드 선택 모달 --- */
.nb-mode-modal {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.9); backdrop-filter: blur(10px);
  display: flex; flex-direction: column; justify-content: center; align-items: center;
  z-index: 110; opacity: 0; pointer-events: none; transition: opacity 0.3s;
}
.nb-mode-modal.active { opacity: 1; pointer-events: auto; }

.nb-mode-btn-group { display: flex; gap: 30px; margin-top: 50px; }
.nb-mode-btn {
  width: 120px; height: 120px; border-radius: 20px;
  background: transparent; border: 3px solid #fff; color: #fff;
  font-size: 2rem; font-weight: bold; cursor: pointer;
  display: flex; flex-direction: column; justify-content: center; align-items: center;
  transition: all 0.2s;
}
.nb-mode-btn span { font-size: 1rem; margin-top: 5px; opacity: 0.7; }
.nb-mode-btn:hover { background: #fff; color: #000; transform: scale(1.1); box-shadow: 0 0 30px #fff; }

/* --- 결과 화면 --- */
.nb-result-screen {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.95); z-index: 120;
  display: flex; flex-direction: column; justify-content: center; align-items: center;
  opacity: 0; pointer-events: none; transition: opacity 0.5s;
}
.nb-result-screen.active { opacity: 1; pointer-events: auto; }
.nb-res-grade { font-size: 8rem; font-weight: 900; margin-bottom: 20px; }
.nb-res-score { font-size: 3rem; color: #fff; margin-bottom: 40px; }
.nb-back-btn {
  padding: 15px 50px; background: transparent; border: 2px solid #00ffff; color: #00ffff;
  font-size: 1.5rem; cursor: pointer; font-family: 'Orbitron';
}
.nb-back-btn:hover { background: #00ffff; color: #000; }

@keyframes judgePop { 0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; } 50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; } 100% { transform: translate(-50%, -50%) scale(1); opacity: 0; } }