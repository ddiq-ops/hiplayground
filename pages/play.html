<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê²Œì„ í”Œë ˆì´ - í•˜ì´ í”Œë ˆì´ê·¸ë¼ìš´ë“œ</title>
  
  <!-- Domain Security Check -->
  <script src="../assets/js/security.js"></script>
  
  <!-- CSS -->
  <link rel="stylesheet" href="../assets/css/base.css">
  <link rel="stylesheet" href="../assets/css/theme.css">
  <link rel="stylesheet" href="../assets/css/components.css">
  <link rel="stylesheet" href="../shared/game-shell.css">
  
  <style>
    /* Game Description Section Styles (SEO optimized) */
    .game-description-section {
      background-color: #f9f9f9;
      padding: var(--spacing-2xl) 0;
      margin-top: 0;
      border-top: 2px solid var(--color-border);
    }
    
    .game-description-section .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 var(--spacing-lg);
    }
    
    .description-block {
      background-color: #ffffff;
      padding: var(--spacing-xl);
      margin-bottom: var(--spacing-xl);
      border-radius: var(--radius-lg);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    
    .description-block:last-child {
      margin-bottom: 0;
    }
    
    .description-block h2 {
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--color-text);
      margin: 0 0 var(--spacing-lg) 0;
      padding-bottom: var(--spacing-md);
      border-bottom: 2px solid var(--color-primary);
    }
    
    .description-block p {
      font-size: 1rem;
      line-height: 1.8;
      color: var(--color-text);
      margin: 0 0 var(--spacing-md) 0;
    }
    
    .description-block p:last-child {
      margin-bottom: 0;
    }
    
    .description-block ol,
    .description-block ul {
      font-size: 1rem;
      line-height: 1.8;
      color: var(--color-text);
      margin: 0 0 var(--spacing-md) 0;
      padding-left: var(--spacing-xl);
    }
    
    .description-block li {
      margin-bottom: var(--spacing-sm);
    }
    
    .description-block li:last-child {
      margin-bottom: 0;
    }
    
    .description-block ol li {
      margin-bottom: var(--spacing-md);
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .game-description-section {
        padding: var(--spacing-xl) 0;
      }
      
      .game-description-section .container {
        padding: 0 var(--spacing-md);
      }
      
      .description-block {
        padding: var(--spacing-lg);
        margin-bottom: var(--spacing-lg);
      }
      
      .description-block h2 {
        font-size: 1.5rem;
        margin-bottom: var(--spacing-md);
      }
      
      .description-block p,
      .description-block ol,
      .description-block ul {
        font-size: 0.95rem;
        line-height: 1.7;
      }
      
      .description-block ol,
      .description-block ul {
        padding-left: var(--spacing-lg);
      }
    }
    
    @media (max-width: 480px) {
      .description-block h2 {
        font-size: 1.25rem;
      }
      
      .description-block p,
      .description-block ol,
      .description-block ul {
        font-size: 0.9rem;
        line-height: 1.6;
      }
      
      .description-block ol,
      .description-block ul {
        padding-left: var(--spacing-md);
      }
    }
  </style>
</head>
<body>
  <div id="game-area">
    <!-- Game Header -->
    <header id="game-header">
      <div class="game-header-left">
        <button id="btn-back" class="game-header-btn" data-i18n-title="play.back" title="ë’¤ë¡œ">â†</button>
      </div>
      <div class="game-header-center">
        <h1 id="game-title" data-i18n="common.loading">ê²Œì„ ë¡œë”© ì¤‘...</h1>
      </div>
      <div class="game-header-right">
        <button id="btn-reset" class="game-header-btn" data-i18n-title="play.reset" title="ë¦¬ì…‹">ğŸ”„</button>
        <button id="btn-fullscreen" class="game-header-btn" data-i18n-title="play.fullscreen" title="ì „ì²´í™”ë©´">â›¶</button>
        <button id="btn-mute" class="game-header-btn" data-i18n-title="play.mute" title="ìŒì†Œê±°">ğŸ”Š</button>
      </div>
    </header>

    <!-- Game Stats (optional, can be hidden if game doesn't use it) -->
    <div id="game-stats" style="display: none;">
      <div class="game-stat">
        <div class="game-stat-label" data-i18n="play.score">ì ìˆ˜</div>
        <div class="game-stat-value" id="game-score">0</div>
      </div>
      <div class="game-stat">
        <div class="game-stat-label" data-i18n="play.level">ë ˆë²¨</div>
        <div class="game-stat-value" id="game-level">1</div>
      </div>
    </div>

    <!-- Game Container -->
    <div id="game-container">
      <div class="loading-container">
        <div class="spinner"></div>
        <p style="margin-top: var(--spacing-md);" data-i18n="common.loadingGame">ê²Œì„ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
      </div>
    </div>
  </div>

  <!-- Game Description Section (SEO optimized) -->
  <section id="game-description-section" class="game-description-section" style="display: none;">
    <div class="container">
      <div id="game-description-content"></div>
    </div>
  </section>

  <!-- JavaScript -->
  <script src="../assets/js/storage.js"></script>
  <script src="../assets/js/i18n.js"></script>
  <script src="../assets/js/language-selector.js"></script>
  <script src="../assets/js/analytics.js"></script>
  <script src="../assets/js/router.js"></script>
  <script src="../assets/js/app.js"></script>
  <script src="../assets/js/game-descriptions.js"></script>
  <script src="../shared/game-shell.js"></script>
  
  <script>
    /**
     * Load and render game description for SEO
     */
    function loadGameDescription(gameId) {
      try {
        // Wait for I18n to be ready
        if (typeof I18n === 'undefined') {
          console.warn('I18n not loaded yet');
          setTimeout(() => loadGameDescription(gameId), 500);
          return;
        }
        
        // Get description data from I18n system (falls back to GameDescriptions)
        const descriptionData = I18n.getGameDescriptionData(gameId);
        
        if (!descriptionData) {
          // If no specific description, use default from game data
          const game = App.getGameById(gameId);
          if (game) {
            renderDefaultDescription(game);
          }
          return;
        }
        
        const section = document.getElementById('game-description-section');
        const content = document.getElementById('game-description-content');
        
        if (!section || !content) return;
        
        let html = '';
        
        // How to Play section
        if (descriptionData.howToPlay && descriptionData.howToPlay.title) {
          html += '<div class="description-block">';
          html += `<h2>${descriptionData.howToPlay.title}</h2>`;
          if (descriptionData.howToPlay.steps && descriptionData.howToPlay.steps.length > 0) {
            html += '<ol>';
            descriptionData.howToPlay.steps.forEach(step => {
              html += `<li>${step}</li>`;
            });
            html += '</ol>';
          }
          html += '</div>';
        }
        
        // Strategy section
        if (descriptionData.strategy && descriptionData.strategy.title) {
          html += '<div class="description-block">';
          html += `<h2>${descriptionData.strategy.title}</h2>`;
          if (descriptionData.strategy.tips && descriptionData.strategy.tips.length > 0) {
            html += '<ul>';
            descriptionData.strategy.tips.forEach(tip => {
              html += `<li>${tip}</li>`;
            });
            html += '</ul>';
          }
          html += '</div>';
        }
        
        // About section
        if (descriptionData.about && descriptionData.about.title) {
          html += '<div class="description-block">';
          html += `<h2>${descriptionData.about.title}</h2>`;
          if (descriptionData.about.description) {
            html += `<p>${descriptionData.about.description}</p>`;
          }
          html += '</div>';
        }
        
        content.innerHTML = html;
        section.style.display = 'block';
      } catch (error) {
        console.error('Error loading game description:', error);
      }
    }
    
    /**
     * Render default description if specific one doesn't exist
     */
    function renderDefaultDescription(game) {
      const section = document.getElementById('game-description-section');
      const content = document.getElementById('game-description-content');
      
      if (!section || !content) return;
      
      let html = '';
      html += '<div class="description-block">';
      html += '<h2>ê²Œì„ ë°©ë²• (How to Play)</h2>';
      html += `<p>${game.description}</p>`;
      html += '<p>ê²Œì„ì„ ì‹œì‘í•˜ì—¬ ì¦ê¸°ì„¸ìš”. ìƒì„¸í•œ ê²Œì„ ë°©ë²•ì€ ê²Œì„ ë‚´ì—ì„œ ì•ˆë‚´ë©ë‹ˆë‹¤.</p>';
      html += '</div>';
      
      html += '<div class="description-block">';
      html += '<h2>ê²Œì„ ì†Œê°œ (About)</h2>';
      html += `<p>${game.title}ì€(ëŠ”) ${game.category} ì¹´í…Œê³ ë¦¬ì˜ ê²Œì„ìœ¼ë¡œ, ì¬ë¯¸ìˆê³  êµìœ¡ì ì¸ ê²½í—˜ì„ ì œê³µí•©ë‹ˆë‹¤. ê²Œì„ì„ í†µí•´ ë‘ë‡Œ íšŒì „ê³¼ ì¬ë¯¸ë¥¼ ë™ì‹œì— ëŠë‚„ ìˆ˜ ìˆìœ¼ë©°, ë‹¤ì–‘í•œ ëŠ¥ë ¥ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>`;
      html += '</div>';
      
      content.innerHTML = html;
      section.style.display = 'block';
    }
    
    // Page-specific script
    (async function() {
      await App.init();
      
      // Get game ID from URL parameter
      const urlParams = new URLSearchParams(window.location.search);
      const gameId = urlParams.get('id');
      
      if (!gameId) {
        alert('ê²Œì„ IDê°€ ì—†ìŠµë‹ˆë‹¤.');
        window.location.href = '../index.html';
        return;
      }
      
      // Verify game exists
      const game = App.getGameById(gameId);
      if (!game) {
        alert('ê²Œì„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        window.location.href = '../index.html';
        return;
      }
      
      // Initialize game shell
      await GameShell.init(gameId);
      
      // Load and display game description (after game is loaded)
      loadGameDescription(gameId);
      
      // Reload description when language changes
      document.addEventListener('i18n:loaded', () => {
        loadGameDescription(gameId);
        // Also update game title in header
        if (typeof GameShell !== 'undefined' && GameShell.gameId) {
          const title = document.getElementById('game-title');
          if (title && typeof I18n !== 'undefined') {
            // Get manifest to update title
            GameShell.loadManifest(gameId).then(manifest => {
              if (manifest) {
                title.textContent = I18n.getGameTitle(gameId, manifest);
              }
            });
          }
        }
      });
      
      // Track page view
      Analytics.trackPageView(`play:${gameId}`);
    })();
  </script>
</body>
</html>

